---
platform: linux

image_resource:
  type: docker-image
  source:
    repository: ruby
    tag: '2.1'

inputs:
  - name: source
  - name: version

outputs:
  - name: site
    path: site

run:
  path: sh
  args:
  - -exc
  - |
    cd source
    bundler install
    jekyll build
    version=`cat ../version/version`
    cd _site && tar cvzf ../../site/site-${version}.tgz .